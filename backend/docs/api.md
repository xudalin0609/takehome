# Backend Projects

- [Simple OCR Letters](https://github.com/teletraan/takehome/blob/master/backend/simple_ocr_letters.md)



## ocr

### 方案
[设计文档](./docs/design-document.md)

### 接口列表
ip|port|api|method|content
--|--|--|--|--
http://127.0.0.1:5000 | 5000 | /api/v1/ocr | ['POST'] | 传入图片，进行ocr，列表形式返回结果
http://127.0.0.1:5000 | 5000 | /api/v1/ocr | ['GET'] | 返回历史ocr的结果


### 参数列表
参数|解释|备注|方法
--|--|--|--
file | 上传的图片文件 | 必须传入| ['POST']
limit | 返回历史ocr结果的条数 | 默认为10 | ['GET']
ocr_message_id | 返回特定id的ocr结果 | - | ['GET']

### 返回示例
参数|解释|备注
--|--|--
code | 状态码 | [错误码](./docs/err-code.md)
data | 结果集 | 格式为列表
errMsg | 接口错误原因 | 正确为空字符串


### python request demo
```python
    def ocr_post():
        url = "http://127.0.0.1:5000/api/v1/ocr"
        with open("./test/test_materail/test.png", 'rb') as f:
            file = f.read()
        files = {
            "file": ("filename1.png", file),
        }
        r = requests.post(url=self.url, files=files)
        return r.json()

>>> {
    "code": 0,
    "data": {
        "content": [
            "风",
            "急",
            "天",
            "高",
            "猿",
            "喝",
            "哀",
            "渚",
            "清",
            "沙",
            "白",
            "鸟",
            "飞",
            "回",
            "无",
            "边",
            "落",
            "木",
            "萧",
            "萧",
            "下",
            "不",
            "尽",
            "长",
            "江",
            "滚",
            "滚",
            "来",
            "万",
            "里",
            "悲",
            "秋",
            "常",
            "作",
            "客",
            "百",
            "年",
            "多",
            "病",
            "独",
            "登",
            "台",
            "艰",
            "难",
            "苦",
            "恨",
            "繁",
            "霜",
            "鬓",
            "漫",
            "倒",
            "新",
            "停",
            "浊",
            "酒",
            "杯"
        ]
    },
    "errMsg": "",
    "unixTime": 1591253880
```

```python
    def test_ocr_get_args():
        url = "http://127.0.0.1:5000/api/v1/ocr"
        params = {'ocr_message_id': 1, 'limit': 1}
        r = requests.get(url=self.url, params=params)
        return r.json()

>>> {
    "code": 0,
    "data": {
        "content": {
            "1c370314b897319fa67b6738d52c2129": "['风', '急', '天', '高', '猿', '喝', '哀', '渚', '清', '沙', '白', '鸟', '飞', '回', '无', '边', '落', '木', '萧', '萧', '下', '不', '尽', '长', '江', '滚', '滚', '来', '万', '里', '悲', '秋', '常', '作', '客', '百', '年', '多', '病', '独', '登', '台', '艰', '难', '苦', '恨', '繁', '霜', '鬓', '漫', '倒', '新', '停', '浊', '酒', '杯']",
            "5aa271a291433102a4ac0bbfcc458fe5": "['风', '急', '天', '高', '猿', '喝', '哀', '渚', '清', '沙', '白', '鸟', '飞', '回', '无', '边', '落', '木', '萧', '萧', '下', '不', '尽', '长', '江', '滚', '滚', '来', '万', '里', '悲', '秋', '常', '作', '客', '百', '年', '多', '病', '独', '登', '台', '艰', '难', '苦', '恨', '繁', '霜', '鬓', '漫', '倒', '新', '停', '浊', '酒', '杯']",
            "7278ead26f743db7b02b6cf7aac6d7aa": "['风', '急', '天', '高', '猿', '喝', '哀', '渚', '清', '沙', '白', '鸟', '飞', '回', '无', '边', '落', '木', '萧', '萧', '下', '不', '尽', '长', '江', '滚', '滚', '来', '万', '里', '悲', '秋', '常', '作', '客', '百', '年', '多', '病', '独', '登', '台', '艰', '难', '苦', '恨', '繁', '霜', '鬓', '漫', '倒', '新', '停', '浊', '酒', '杯']"
        }
    },
    "errMsg": "",
    "unixTime": 1591253930
}
```
